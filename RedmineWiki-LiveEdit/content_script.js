var url;url=location.href,/redmine/.test(url)&&(/\/edit$/.test(url)||/\/edit\?.+$/.test(url))&&(chrome.extension.sendRequest({},function(a){}),function(a,b){var c,d,e,f;return f=a.createElement("style"),d=".jstEditor { overflow: hidden; }  #content_text, #preview { width: 49.5%; max-width: 50%; }  #content_text { box-sizing: border-box; position: relative; float: left; }  #preview { float: right; }  #preview fieldset { margin-top: 0; }  #preview legend { display: none; }",c=function(){function c(){var b=this;this.form=a.getElementById("wiki_form"),this.editor=a.getElementById("content_text"),this.origPreview=a.getElementById("preview"),this.preview=this.origPreview.cloneNode(),this.keyTimerId=null,this.origValues=function(a){var c,d,e,f;return f=a[a.length-1].getElementsByTagName("a")[0],d=f.getAttribute("onclick"),/^new\sajax\.updater/i.test(d)?(e=/\(\'\w+\',\s\'(.+\/preview)\',\s.+encodeURIComponent\(\'(.+)\'\)/g,c=e.exec(d),{url:c[1],token:encodeURIComponent(c[2])}):(e=/\w+\(\"(.+\/preview)\"\,\s/g,c=e.exec(d),{url:c[1],token:b.form.authenticity_token.value})}(this.form.getElementsByTagName("p")),this.baseParams=function(a){var c,d;for(c=b.form.getElementsByTagName("input"),d=[];a<c.length;)d.push(b.serializer(c[a])),a++;return d.push("authenticity_token="+b.origValues.token),d.join("&")}(0),this.initElement(),this.observeKeyEvent()}return c.prototype.initElement=function(){return this.editor.parentNode.insertBefore(this.preview,this.editor.nextSibling),this.origPreview.parentNode.removeChild(this.origPreview),f.innerText=d,a.body.appendChild(f),this.updatePreview()},c.prototype.observeKeyEvent=function(){var a=this;return this.editor.addEventListener("keyup",function(){return clearTimeout(a.keyTimerId),a.keyTimerId=setTimeout(function(){return a.updatePreview()},1e3)},!1)},c.prototype.serializer=function(a){var b,c;return b=encodeURIComponent(a.name).replace(/%20/g,"+"),c=a.value.replace(/(\r)?\n/g,"\r\n"),c=encodeURIComponent(c).replace(/%20/g,"+"),""+b+"="+c},c.prototype.updatePreview=function(){var c,d,e=this;return d=a.getElementById("ajax-indicator"),c=function(){return e.editor.style.minHeight=""+e.preview.offsetHeight+"px",d.style.display="none"},function(a){return b.onreadystatechange=function(){return 4===b.readyState&&200===b.status?(e.preview.innerHTML=b.responseText,c()):d.style.display="block"},b.open("post",e.origValues.url,!0),b.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),b.setRequestHeader("X-CSRF-Token",e.origValues.token),b.send(""+e.baseParams+"&"+a)}(this.serializer(this.editor))},c}(),e=new c}(this.document,new XMLHttpRequest));